# 从零开始搭建一个博客

## 0x00：准备

要准备的材料有

- 一台服务器
- 一个域名
- 一个钛合金Tab

- 一个SSH工具

## 0x01：域名部分

域名部分使用阿里云中国站的万网服务。

打开万网官网https://wanwang.aliyun.com/，输入自己想要的域名查找

![1567221250414](assets/1567221250414.png)

选择加入清单然后立即结算。

![1567221282290](assets/1567221282290.png)

所有增值服务都不需要。

![1567221345236](assets/1567221345236.png)

然后回到域名控制台，就可以看到新买的域名了。

![1567221410964](assets/1567221410964.png)

此时域名准备完成。

## 0x02：服务器部分

服务器部分境内外只要是个服务器就能用，不过境内服务器如果需要开80端口的话需要备案，建议交流学习用可以使用境外的服务器。

本处使用的是阿里云国际版香港节点，系统为Ubuntu 18.04。

需要注意的是，阿里云中国站和国际站账号不互通。

![1567220410913](assets/1567220410913.png)

先登录阿里云国际版的网址：[https://www.alibabacloud.com](https://www.alibabacloud.com/)

![1567220512910](assets/1567220512910.png)

在产品下面选择云服务器ECS

![1567220593277](assets/1567220593277.png)

往下拉，有个【新手套餐全面升级（2.0版）】便宜一点

![1567220752838](assets/1567220752838.png)

![1567220796813](assets/1567220796813.png)

安骑士我取消掉了，不想给阿里云留后门，然后立即购买

![1567220869823](assets/1567220869823.png)

然后购买用Paypal或者信用卡支付就可以了。

![1567220967639](assets/1567220967639.png)

支付完成后，点开控制台[https://home-intl.console.aliyun.com](https://home-intl.console.aliyun.com/)

左上角三道杠-产品与服务-云服务器ECS

![1567221018133](assets/1567221018133.png)

选择左边菜单实例，就能看到自己的服务器了

![1567221087776](assets/1567221087776.png)

框柱的地方就是IP地址，可以使用SSH进行连接，服务器准备完成。

## 0x03：LNMP大礼包安装

安装教程官网上写的很清楚了，此处不再赘述。

地址：<https://lnmp.org/install.html>

这里我选择MySQL 5.5.60(Default) + PHP 7.2.6（最新） + Nginx，另外要注意安装的是LNMP不是LAMP也不是LNMPA

## 0x04：Take a break

到这一步，你现在应该拥有：

- 一台安装好LNMP的服务器
- 一个注册好的域名

## 0x05：建立网站

现在输入网站的IP地址应该已经可以看到下面的画面

![1567232821869](assets/1567232821869.png)

接下来用SSH连上服务器，安装我们的wordpress

现在lnmp创建一个新的vhost，输入下面命令并按照脚本提示选择即可。

Tip：如果脚本内需要退格，应该按Ctrl+退格键而不是直接退格键

```shell
lnmp vhost add
```

![1567233095881](assets/1567233095881.png)

上述从上到下的翻译：

设置域名，设置更多域名，网站根目录，允许伪静态，允许PHP的pathinfo函数，启用访问记录，创建MySQL数据库并设置密码，启动SSL加密。除了域名和数据库密码需要自行设置之外，其他可以参考上面。

先进入wordpress主页：https://cn.wordpress.org/download/，并且下载安装包

```
wget https://cn.wordpress.org/latest-zh_CN.tar.gz 
tar -zxf latest-zh_CN.tar.gz 

```

![1567233671781](assets/1567233671781.png)

然后就可以将解压出来的wordpress文件夹中的所有文件移动到lnmp的网站根目录下面了，一般来说，根目录路径为 /home/wwwroot/你的域名/ 

```
mv wordpress/* /home/wwwroot/你的域名/
cd /home/wwwroot/你的域名/
```

cd到对应目录确认一下文件，但是发现用户组还是root，这里需要改为www:www

![1567233856970](assets/1567233856970.png)

```
chown -R www:www *
ll
```

![1567233974180](assets/1567233974180.png)

好现在正常了。

## 0x06：设置域名

回到阿里云域名控制台，点击续费隔壁的解析。

![1567234111120](assets/1567234111120.png)

选择添加记录

![1567234186085](assets/1567234186085.png)

添加A记录，主机记录填写在0x05部中建立vhost时候的域名，记录值写服务器IP地址，其他不用管。

![1567234235888](assets/1567234235888.png)

## 0x07：著名的五分钟安装

打开上一步设置的域名，你现在应该能看到著名的五分钟安装了~

![1567234359388](assets/1567234359388.png)

分别设置我们在0x05步骤设置的数据库用户名和密码。

![1567234381065](assets/1567234381065.png)

安装。

![1567234393946](assets/1567234393946.png)

接下来是一些个性化设置。

![1567234420018](assets/1567234420018.png)

安装完成！

![1567234458947](assets/1567234458947.png)

登录。

![1567234488618](assets/1567234488618.png)

Enjoy！

## 0x08：FAQ

Q：为什么我连不上服务器？

A：可能是没设置安全组，进入实例列表-更多-网络和安全组-安全组配置

![1567235047146](assets/1567235047146.png)

选择右上角的快速添加规则

![1567235141421](assets/1567235141421.png)

选择需要开放的端口，规则方向入方向允许，授权对象填写目标的CIDR网段地址，如果对全部公网开放则填写0.0.0.0/0，然后确认保存即可。

![1567235128968](assets/1567235128968.png)

如果以上操作后还不行你可能要看一看是不是iptables封掉了端口。

Tip：iptables默认开放80,443等端口但封3306。